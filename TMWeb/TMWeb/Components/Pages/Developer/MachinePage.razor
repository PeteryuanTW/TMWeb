@page "/Machine/{machineId}"
@rendermode InteractiveServer

<MachineDashboard MachineId="@machineId"></MachineDashboard>


@code {
    [Parameter]
    public string machineId { get; set; }
    // private Machine? machine;
    // private bool hasMachine => machine != null;

    // private IEnumerable<ConnectType> connectionType = Enum.GetValues(typeof(ConnectType)).Cast<ConnectType>();
    // private IEnumerable<TagCategory> tagCategories = new List<TagCategory>();

    // private bool drawerOpen = false;
    // private Tag? targetTag;

    // private bool setVal_bool = false;
    // private ushort setVal_ushort = 0;
    // private float setVal_float = 0;
    // private string setVal_string = string.Empty;

    // protected override async Task OnInitializedAsync()
    // {
    //     await InitParam();

    // }

    // public void Dispose()
    // {
    //     if (hasMachine)
    //     {
    //         machine.MachineStatechangedAct -= StatusUpdate;
    //         machine.TagsStatechangedAct -= TagUpdate;
    //     }

    // }

    // private async Task InitParam()
    // {
    //     machine = await machineService.GetMachineByID(new Guid(machineId));
    //     if (hasMachine)
    //     {
    //         await RetriveTagCategory();
    //         //machine.MachineStatechangedAct += UpdateUI;
    //         machine.MachineStatechangedAct += StatusUpdate;
    //         machine.TagsStatechangedAct += TagUpdate;
    //     }
    // }

    // private async Task RetryInitMachine()
    // {
    //     if (hasMachine)
    //     {
    //         machine?.InitMachine();
    //         await machine?.ConnectAsync();
    //     }
    //     await InvokeAsync(StateHasChanged);
    // }

    // private void OpenDrawer()
    // {
    //     drawerOpen = true;
    // }

    // private void CloseDrawer()
    // {
    //     drawerOpen = false;
    // }

    // private async void StatusUpdate(Status status)
    // {
    //     await InvokeAsync(StateHasChanged);
    // }

    // private async void TagUpdate()
    // {
    //     await InvokeAsync(StateHasChanged);
    // }

    // private async Task RetriveTagCategory()
    // {
    //     tagCategories = await shopfloorService.GetCategoryByConnectionType(machine.ConnectionType);
    // }

    // private async void ConnectTypeChanged(ConnectType ct)
    // {
    //     machine.ConnectionType = (int)ct;
    //     await RetriveTagCategory();
    // }


    // private void SelectedNewCategry(Guid? id)
    // {
    //     machine.TagCategoryId = id;
    // }

    // private async Task UpdateTagClicked(Object tagObj)
    // {
    //     targetTag = tagObj as Tag;
    //     if (targetTag != null)
    //     {
    //         await machine?.UpdateTag(targetTag);
    //     }

    // }

    // private void SetTagClicked(Object tagObj)
    // {

    //     targetTag = tagObj as Tag;
    //     if (targetTag != null)
    //     {
    //         switch (targetTag.DataType)
    //         {
    //             case 1:
    //                 setVal_bool = (bool)targetTag.Value;
    //                 break;
    //             case 2:
    //                 setVal_ushort = (ushort)targetTag.Value;
    //                 break;
    //             default:
    //                 break;

    //         }
    //         OpenDrawer();
    //     }

    // }

    // private async Task SetTagValue(Object tagObj)
    // {
    //     Tag? targetTag = tagObj as Tag;
    //     if (targetTag != null)
    //     {
    //         switch (targetTag.DataType)
    //         {
    //             case 1:
    //                 await machine.SetTag(targetTag, setVal_bool);
    //                 break;
    //             case 2:
    //                 await machine.SetTag(targetTag, setVal_ushort);
    //                 break;
    //             case 3:
    //                 await machine.SetTag(targetTag, setVal_float);
    //                 break;
    //             case 4:
    //                 await machine.SetTag(targetTag, setVal_string);
    //                 break;
    //             default:
    //                 break;

    //         }
    //     }
    //     CloseDrawer();
    // }
}
